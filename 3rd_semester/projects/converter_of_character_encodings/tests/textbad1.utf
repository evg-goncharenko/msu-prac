Разработка программ-конвертеров кодировок UCS-2
Задание практикума (3 еместр)

Постановка задачи
Требуется разработать две программы-конвертера.
Первая программа читает из стандартного канала ввода текст в кодировке USC-2, переводит его в кодировку UTF-8 и выводит перекодированный текст в стандартный канал вывода.
Вторая программа читает из стандартного канала ввода текст в кодировке UTF-8, переводит его в кодировку USC-2 и выводит перекодированный текст в стандартный канал вывода.
Обе программы должны корректно обрабатывать маркер порядка байтов (byte order mark – BOM) – символ с кодом 0xFEFF — в начале файла. Первая программа должна читать текст в UCS-2, а вторая программа — генерировать текст в USC-2 в соответствии с прочитанным маркером. В случае отсутствия маркера принимается LE-порядок (то есть по умолчанию BOM представлен байтами 0xFF 0xFE в начале файла).
Также программы должны обрабатывать и случаи некорректного представления входного текста — нечетное количество байтов в USC-2, некорректные последовательности в UTF-8. В этих случаях программы должны выдавать в стандартный канал вывода сообщений об ошибках (stderr) диагностику, включающую в себя значение некорректного символа (последовательности), а также его смещение относительно начала файла.
Заметим, что программы не должны сами генерировать маркер BOM — тот должен находиться в тексте (в начале файла).
К заданию приложены тестовые файлы в обеих кодировках для контроля правильности заданий, а также для отладки программ.
Методические указания
Задание нужно реализовать на языке Си в операционной системе UNIX (LINUX).
Для хранения UCS-символов следует использовать тип данных unsigned short, а для UTF-8 символов -  char.
Так как выполнение задания предполагается в начале семестра, то знакомство с двоичным вводом-выводом не предусматривается, а для ввода-вывода текста используются только библиотечные функции getchar() и putchar(). При тестировании и отладке программ должны использоваться данные из заранее подготовленных файлов. Эти файлы связываются со стандартными каналами ввода-вывода путем механизма перенаправления ввода-вывода, предоставляемого любой оболочкой в ОС UNIX:
utf2usc <le.ucs >le.utf
Пример функции ввода USC-символа при прямом представлении USC-2 (то есть BE-порядка байтов):
unsigned short get_unicode_char_be ()
{
	int byte1 = getchar(), byte2 = getchar();
	return ((byte1&0xFF) << 8 | byte2&0xFF);
}
Тестовые файлы
Для тестирования и отладки предлагается использовать следующий (минимальный) набор файлов.
UCS-2 файлы
letext.usc – текст в  UCS-2 в перевернутом представлении (LE-порядок) с меткой BOM
betext.usc – текст в  UCS-2 в прямом представлении (BE-порядок) с меткой BOM
letextbad1.usc – текст в  UCS-2 в перевернутом представлении (LE-порядок) без метки BOM
betextbad1.usc – текст в  UCS-2 в прямом представлении (BE-порядок) без метки BOM
letextbad2.usc – текст в  UCS-2 в перевернутом представлении (LE-порядок) с меткой BOM, но с неверным символом (однобайтовым)
betextbad2.usc – текст в  UCS-2 в прямом представлении (BE-порядок) с меткой BOM, но с неверным символом (однобайтовым)
leempty.usc – пустой текст в  UCS-2 в перевернутом представлении (LE-порядок) с меткой BOM
beempty.usc – пустой текст в  UCS-2 в прямом представлении (BE-порядок) с меткой BOM
le30.usc – односимвольный (код=0x30 – символ 0) текст в  UCS-2 в перевернутом представлении (LE-порядок) с меткой BOM
be30.usc – односимвольный (код=0x30 – символ 0) текст в  UCS-2 в прямом представлении (BE-порядок) с меткой BOM
le42f.usc – односимвольный (код=0x042F – символ Я) текст в  UCS-2 в перевернутом представлении (LE-порядок) с меткой BOM
be42f.usc – односимвольный (код=0x042F  – символ Я) текст в  UCS-2 в прямом представлении (BE-порядок) с меткой BOM
le263A.usc – односимвольный (код=0x263A – символ ☺) текст в  UCS-2 в перевернутом представлении (LE-порядок) с меткой BOM
be262A.usc – односимвольный (код=0x263A  – символ ☺ текст в  UCS-2 в прямом представлении (BE-порядок) с меткой BOM
UTF-8 файлы
text.utf – текст в UTF-8 с меткой BOM (кодированной)
text2.utf – текст в UTF-8 без метки BOM
textbad1.utf – текст в UTF-8 с неверной последовательностью (начинается с байта продолжения) без метки BOM
textbad2.utf – текст в UTF-8 с неверной последовательностью (отсутствует байт продолжения) без метки BOM
empty.utf – пустой текст в UTF-8 с меткой BOM
30.utf – односимвольный (код=0x30 – символ 0) текст в UTF-8
42f.utf – односимвольный (код=0x042F – символ Я) текст в UTF-8
263A.utf – односимвольный (код=0x263A – символ ☺) текст в UTF-8
